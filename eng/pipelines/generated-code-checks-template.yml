parameters:
    pythonVersion: ""
    folderName: ""
    pythonCodeChecks: and(succeeded(), )

steps:
    - checkout: self
    - checkout: azure-sdk-tools
    - template: eng/common/testproxy/test-proxy-tool.yml@azure-sdk-tools
      parameters:
          TestProxy: true
          templateRoot: azure-sdk-tools

    - script: cd $(Build.SourcesDirectory)/autorest.python/packages/autorest.python/test/${{ parameters.folderName }}

    - script: tox -e ci
      displayName: Execute ${{ parameters.folderName }} tests - Python ${{ parameters.pythonVersion }}

    - script: tox -e apiview
      displayName: ApiView ${{ parameters.folderName }}

    - script: tox -e lint
      displayName: Lint ${{ parameters.folderName }}
      condition: and(succeeded(), eq(${{ parameters.pythonVersion }}, '3.7'), in(${{ parameters.folderName }}, "version-tolerant"))

    - script: tox -e mypy
      displayName: Mypy ${{ parameters.folderName }}
      condition: and(succeeded(), eq(${{ parameters.pythonVersion }}, '3.11'), in(${{ parameters.folderName }}, "version-tolerant"))

    - script: tox -e pyright
      displayName: Pyright ${{ parameters.folderName }}
      condition: and(succeeded(), eq(${{ parameters.pythonVersion }}, '3.10'), in(${{ parameters.folderName }}, "version-tolerant"))
